<div class="users-page">
  <div class="header">
    <h2>Users</h2>
    <button (click)="openCreate()">Add user</button>
  </div>

  <div *ngIf="error" class="error">{{ error }}</div>
  <div *ngIf="loading">Loading...</div>

  <table *ngIf="!loading" class="users-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>First name</th>
        <th>Last name</th>
        <th>Email</th>
        <th>Username</th>
        <th>Role</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let u of users">
        <td>{{ u.id }}</td>
        <td>{{ u.first_name }}</td>
        <td>{{ u.last_name }}</td>
        <td>{{ u.email }}</td>
        <td>{{ u.username }}</td>
        <td>{{ u.role }}</td>
        <td class="actions">
          <button title="Edit" (click)="openEdit(u)">‚úèÔ∏è</button>
          <button title="Delete" [disabled]="!canDelete()" (click)="remove(u)">üóëÔ∏è</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Simple modal -->
  <div class="modal-overlay" *ngIf="showForm" (click)="closeForm()"></div>
  <div class="modal" *ngIf="showForm">
    <div class="modal-header">
      <h3>{{ formMode === 'create' ? 'Create user' : 'Edit user' }}</h3>
      <button class="close" (click)="closeForm()">‚úñ</button>
    </div>
    <div class="modal-body">
      <div class="error" *ngIf="formError">{{ formError }}</div>
      <form (ngSubmit)="save()" #f="ngForm">
        <label>
          First name
          <input name="first_name" [(ngModel)]="form.first_name" required minlength="2" />
        </label>
        <label>
          Last name
          <input name="last_name" [(ngModel)]="form.last_name" required minlength="2" />
        </label>
        <label>
          Email
          <input name="email" type="email" [(ngModel)]="form.email" required email />
        </label>
        <label>
          Username
          <input name="username" [(ngModel)]="form.username" required minlength="3" />
        </label>
        <label>
          Password
          <input name="password" type="password" [(ngModel)]="form.password" [required]="formMode==='create'" minlength="6" />
        </label>
        <label>
          Role
          <select name="role" [(ngModel)]="form.role" required>
            <option value="admin">admin</option>
            <option value="generic">generic</option>
          </select>
        </label>
        <div class="modal-actions">
          <button type="submit" [disabled]="f.invalid">Save</button>
          <button type="button" (click)="closeForm()">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>


